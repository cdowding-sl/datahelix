{
  "schemaVersion": "0.11",
  "fields": [
    {
      "name": "user_id",
      "type": "string",
      "nullable": false
    },
    {
      "name": "email_address",
      "type": "string"
    },
    {
      "name": "creation_date",
      "type": "datetime",
      "nullable": false,
      "formatting": "%tF"
    }
  ],
  "rules": [
    {
      "rule": "user_id",
      "constraints": [
        {
          "anyOf": [
            {
              "matchingRegex": {
                "field": "user_id",
                "value": "^[A-Za-z0-9]{3,10}$"
              }
            },
            {
              "matchingRegex": {
                "field": "user_id",
                "value": "^[a-z0-9]+\\@[a-z0-9]+\\.co(m|\\.uk)$"
              }
            }
          ]
        }
      ]
    },
    {
      "rule": "email_address",
      "constraints": [
        {
          "condition": {
            "if": {
              "containingRegex": {
                "field": "user_id",
                "value": "\\@"
              }
            },
            "then": {
              "null": {
                "field": "email_address"
              }
            },
            "else": {
              "allOf": [
                {
                  "not": {
                    "null": {
                      "field": "email_address"
                    }
                  }
                },
                {
                  "matchingRegex": {
                    "field": "email_address",
                    "value": "^[a-z0-9]+\\@[a-z0-9]+\\.co(m|\\.uk)$"
                  }
                }
              ]
            }
          }
        }
      ]
    },
    {
      "rule": "creation_date",
      "constraints": [
        {
          "afterOrAt": {
            "field": "creation_date",
            "value": "2003-01-01T00:00:00.000"
          }
        },
        {
          "beforeOrAt": {
            "field": "creation_date",
            "value": "2020-01-01T00:00:00.000"
          }
        }
      ]
    }
  ]
}